
# Exporting Results

Stat-z core provides multiple ways to export tables generated by the analysis functions.

Covered here:
- `exportCombinedAsHTML`
- `exportCombinedAsMarkdown`
- `exportPosthocComparisonsAsHTML`
- `exportCombinedAsRows` (for Bubble repeating groups / custom UIs)

> Tip: Use `combineAnalysisAsSingleTable(resultObj)` to merge the per-predictor outputs into a single “combined” table before exporting.

---

## 1) Create a combined table

```js
// suppose you already ran `window.Statz.runAnalysis(...)` and got:
const resultObj = {
  analysis: [
    // array of per-predictor result objects,
    // each with a `table` containing columns/rows, p-value, etc.
  ],
  test_legend: []
};

const combined = window.Statz.combineAnalysisAsSingleTable(resultObj);
````

The variable `combined` has the shape:

```js
{
  columns: [...],
  rows: [...],
  test_legend: [...],
  posthoc_legend: [...],
  resid_symbol_greater_used: true|false,
  resid_symbol_lower_used: true|false,
  // optional flags:
  percent_by: "row" | "col",
  percent_total_full: true|false
}
```

---

## 2) Export as HTML

```js
const html = window.Statz.exportCombinedAsHTML(combined, "Analysis Table", /* wrap */ true);

// If wrap=true, you get a full HTML document (good for PDF plugins).
// If wrap=false, only the <table> fragment is returned (good for embedding).
```

Typical use cases:

* **Bubble + PDF plugin (SelectPDF / PDF Conjurer):** use `wrap=true`.
* **In-app preview (HTML element):** use `wrap=false`.

---

## 3) Export as Markdown

```js
const md = window.Statz.exportCombinedAsMarkdown(combined, "Analysis Table");
// Copy/paste into docs or convert to other formats.
```

---

## 4) Export significant post-hoc comparisons as HTML

If your analysis produced post-hoc results (e.g., Dunn after Kruskal–Wallis):

```js
const htmlPosthoc = window.Statz.exportPosthocComparisonsAsHTML(resultObj.analysis, "Significant Multiple Comparisons");
```

You can append this block below the main table or show it in a popup.

---

## 5) Render rows individually (for custom UI)

`exportCombinedAsRows` turns each combined row into a small, reusable object:

```js
const items = window.Statz.exportCombinedAsRows(combined);
/*
[
  { title: "Predictor name", columns: [...], rows: [ { ...one row... } ] },
  ...
]
*/

// Example: feed `items` into a Repeating Group (Bubble)
// and display a minimal row per predictor.
```

---

## 6) Tips

* The **legend** (tests used, post-hoc, residual symbols) is automatically included in the HTML footer by `exportCombinedAsHTML`.
* If your q×q tables used residual symbols (†, \*), the footer will note their meaning.
* When exporting to PDF, prefer the **HTML full document** (`wrap=true`) for best results.

